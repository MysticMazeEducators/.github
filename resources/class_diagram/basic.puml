@startuml

left to right direction
skinparam dpi 600
skinparam linetype ortho
page 2x2
skinparam pageMargin 10

set namespaceSeparator ::

class common::Identifier{
  -id: int
  -alreadyUsed: Set<int> {static}
  --
}

class common::Context<p extends Entity, t extends Entity>{
  -position: Room
  -parent: p
  -target: t
}

interface actions::Action{
  --
  +execute(context: Context): boolean {abstract}
}

class actions::ActionQueue<e extends OrderedAction>{
  -queue: List<e>
  --
  +addAction(action: Action): boolean
  +execute(context: Context): boolean
  +executeAll(context: Context): boolean
  +removeFirst(): boolean
}

class actions::OrderedAction{
  -priority: int
  --
  +CompareTo(other: OrderedAction): int
}

Action <|-- OrderedAction

interface actions::item::ItemAction
interface actions::room::RoomAction
interface actions::human::HumanAction

Action <|-- ItemAction
Action <|-- RoomAction
Action <|-- HumanAction

interface actions::item::UseAction
interface actions::item::PickupAction
interface actions::item::PutdownAction

ItemAction <|-- UseAction
ItemAction <|-- PickupAction
ItemAction <|-- PutdownAction

interface actions::room::EnterAction
interface actions::room::GetDoorsAction

RoomAction <|-- EnterAction
OrderedAction <|-- EnterAction
RoomAction <|-- GetDoorsAction
OrderedAction <|-- GetDoorsAction

interface actions::human::KillAction
interface actions::human::StunAction

HumanAction <|-- KillAction
OrderedAction <|-- KillAction
HumanAction <|-- StunAction
OrderedAction <|-- StunAction

'Item actions
class actions::item::TransistorAction {
  -pair: Item
  -on: boolean
  --
  +execute(context: Context): boolean
}

class actions::item::CamambertAction {
  -duration: int = 3
  -on: boolean
  --
  +execute(context: Context): boolean
}

class actions::item::TVSZAction {
  -duration: int = 3
  --
  +execute(context: Context): boolean
}

class actions::item::BeerGlassAction {
  -duration: int = 3
  -on: boolean
  --
  +execute(context: Context): boolean
}

class actions::item::MaskAction {
  -duration: int = 3
  --
  +execute(context: Context): boolean
}

class actions::item::ClothAction {
  -duration: int = 2
  -on: boolean
  --
  +execute(context: Context): boolean
}

class actions::item::SlipstickAction {
  --
  +execute(context: Context): boolean
}

UseAction <|-- TransistorAction
PutdownAction <|-- TransistorAction
PutdownAction <|-- CamambertAction
PickupAction <|-- TVSZAction
UseAction <|-- BeerGlassAction
UseAction <|-- MaskAction
PutdownAction <|-- ClothAction
PickupAction <|-- SlipstickAction

EnterAction <|-- ClothAction
EnterAction <|-- CamambertAction

KillAction <|-- TVSZAction
KillAction <|-- BeerGlassAction
StunAction <|-- MaskAction

'Room modifiers
class actions::room::GhostDoorsAction{
  -duration: int
  --
  +execute(context: Context): boolean
}

class actions::room::TeacherPresentAction{
  teacherId: Identifier
  --
  +execute(context: Context): boolean
}

GetDoorsAction <|-- GhostDoorsAction
EnterAction <|-- TeacherPresentAction

'Default actions

class actions::human::DKillAction{
  --
  +execute(context: Context): boolean
}

class actions::human::DStunAction{
  --
  +execute(context: Context): boolean
}

KillAction <|-- DKillAction
StunAction <|-- DStunAction

class actions::room::DEnterAction{
  --
  +execute(context: Context): boolean
}

class actions::room::DGetDoorsAction{
  --
  +execute(context: Context): boolean
}

GetDoorsAction <|-- DGetDoorsAction
EnterAction <|-- DEnterAction

class actions::item::DPickupAction{
  --
  +execute(context: Context): boolean
}

class actions::item::DPutdownAction{
  --
  +execute(context: Context): boolean
}

PickupAction <|-- DPickupAction
PutdownAction <|-- DPutdownAction

class common::Entity{
  -id: Identifier
  __
  +processTurn(): boolean {abstract}
}

abstract class common::Human{
  -position: Room
  -inventory: Inventory
  -stunDuration: int
  -stunAction: List<StunAction>
  -killActions: List<KillAction>
  __
  +move(): boolean
  +useItem(): boolean
  +pickUpItem(): boolean
  +dropItem(): boolean
  +dropAllItems(): boolean
  +changeRoom(room: Room): boolean
  +stun(): boolean
  +kill(): boolean
}

class common::human::Student{
  +processTurn(): boolean
  +processUserInput(): boolean
}

class common::human::Teacher{
  +processTurn(): boolean
}

abstract class common::Item{
  -useAction: UseAction
  -pickUpAction: PickupAction
  -putDownAction: PutdownAction
  __
  +pickUp(): boolean
  +putDown(): boolean
  +use(): boolean
  +processTurn(): boolean
}

class common::Door{
  -target: Room
  --
  -open(context: Context): boolean
}

class common::Room{
  -inventory: Inventory
  -playerList: List<Human>
  -doorList: List<Door>
  -getDoorsAction: GetDoorsAction = DGetDoorsAction
  -enterActions: List<EnterAction>
  --
  +getDoors(): List<Door>
  +enter(context: Context): boolean
  +leave(context: Context): boolean
}
class common::Inventory{
  -maxSize: int
  -container: List<Item>
  --
  +transferItems(context: Context, ids: List<Identifier>): boolean
  +sendInventoryList(): boolean
  +selectItem(): Identifier
}
class common::Timer{
  +tick()
}

Entity "1" *-- "1" Identifier
Entity <|-- Human
Entity <|-- Item
Entity <|-- Room
Entity <|-- Door
Human <|-- Student
Human <|-- Teacher
Inventory "1" --* "1" Human
Inventory "1" --* "1" Room
Item "0..n" --* "1" Inventory
Door "1" o-- "1" Room
Room "1" *-- "1..*" Door
Human "1" --o "1" Room
Context "1" --o "1" Room
Context "1" --o "2" Entity


'Connect the actions
Item "1" *-- "1" UseAction
Item "1" *-- "1" PickupAction
Item "1" *-- "1" PutdownAction

Room "1" *-- "1..*" EnterAction: > child
Room "1" *-- "1" GetDoorsAction: > child

Human "1" *-- "1..*" KillAction: > child
Human "1" *-- "1..*" StunAction: > child

@enduml